%% Author: Arpit Aggarwal
clc
close all
clear 
addpath(genpath('pwd'))

dfs = [2587; 143; 16; 820; 1503; 2788; 2661; 268; 31; 361; 92; 1516; 84; 365; 1157; 137; 457; 1583; 2342; 1004; 2009; 31; 821; 1279; 61; 943; 135; 1492; 627; 1013; 731; 396; 346; 592; 45; 722; 1240; 2089; 317; 1207; 98; 53; 1658; 576; 679; 9; 949; 1447; 1583; 1189; 882; 763; 1018; 1091; 1562; 194; 130; 565; 394; 1278; 1891; 2616; 304; 761; 3953; 1799; 880; 518; 1162; 840; 9; 760; 1249; 1446; 883; 455; 116; 976; 1977; 1511; 759; 1233; 1064; 1035; 730; 1155; 976; 3525; 816; 84; 1033; 624; 608; 1278; 395; 468; 886; 420; 575; 91; 90; 1369];
event = [1; 0; 0; 1; 0; 0; 0; 0; 1; 0; 1; 1; 0; 1; 1; 0; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 0; 1; 1; 1; 1; 1; 1; 1; 1; 0; 0; 1; 1; 0; 0; 1; 0; 0; 0; 1; 1; 1; 1; 1; 0; 0; 1; 1; 1; 0; 0; 1; 1; 0; 1; 0; 1; 0; 0; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 0; 1; 1; 1; 1; 0; 1; 1; 1; 1; 1; 0; 0; 1; 1; 1; 1; 1; 1; 0; 0; 0; 1; 1; 1; 1];
clinVarRiskLabelMtx = [0.04675620737610015; 0.0266162538077452; 0.038280003271459785; 0.1459760029267512; 0.06134983129613502; 0.01219575954977446; 0.037302815059539175; 0.040968832506026405; 0.11140751167170122; 0.04397967299215121; 0.024166293333754543; 0.03336582682686747; 0.02357460597664075; 0.017884193313402803; 0.03356432987511809; 0.01849554975203314; 0.029815873545417874; 0.020635280608560066; 0.05474686891057247; 0.018287890392732372; 0.05494153214309447; 0.024036867000000014; 0.043992980383954314; 0.014933932170618232; 0.07625900375056771; 0.02033709399006951; 0.025940600973983638; 0.038365496644154715; 0.03721478861175136; 0.013758935909488157; 0.014256755579220404; 0.04705589804687297; 0.021924707122751595; 0.022949636065092784; 0.009228877262091725; 0.010808072078856723; 0.009431582206472305; 0.031595150498274174; 0.0067237987491733636; 0.01867635647868582; 0.029826848876633987; 0.01590448444908404; 0.022874708065592202; 0.02140811945230902; 0.010496651357607006; 0.025354265469235665; 0.023182021114507775; 0.014313885184871441; 0.036471044812829305; 0.02151348022695387; 0.019264955289059554; 0.03343002676613356; 0.021579263658759014; 0.05436818271461419; 0.02194600240448182; 0.08893634307875987; 0.02307901866595258; 0.026751552222057003; 0.05977120082107035; 0.011953208525732185; 0.029977992458633456; 0.051435678118712885; 0.019155970116863735; 0.004290011087250157; 0.033279131981000264; 0.021377045746152103; 0.018924603961080134; 0.046744695619122825; 0.13600082152296863; 0.029435426046342146; 0.13882306380511047; 0.06283900976586423; 0.12303814199483898; 0.01715841407044653; 0.015309283148030494; 0.027164379480995867; 0.026638541663201346; 0.04079614787517688; 0.0925083254573374; 0.021028288947121398; 0.021093973145594372; 0.01852240710424581; 0.1006948624923845; 0.03032455571482169; 0.02298630962976646; 0.051490224334828215; 0.021846153593849706; 0.02637580488064936; 0.03807121834464474; 0.03252810355119141; 0.07627481971288755; 0.04370427392275561; 0.031189871484883634; 0.034518718415869266; 0.08247122168630405; 0.021458627692582645; 0.02049813980372906; 0.023217749545145158; 0.03491410284572626; 0.09383619631054148; 0.07510700630284547; 0.06912717320110151];

[output] = MatSurv(dfs/30.5, event, clinVarRiskLabelMtx)